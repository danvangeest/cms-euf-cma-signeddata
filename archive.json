{
  "magic": "E!vIA5L86J2I",
  "timestamp": "2025-02-11T01:18:01.781708+00:00",
  "repo": "danvangeest/cms-euf-cma-signeddata",
  "labels": [
    {
      "name": "bug",
      "description": "Something isn't working",
      "color": "d73a4a"
    },
    {
      "name": "documentation",
      "description": "Improvements or additions to documentation",
      "color": "0075ca"
    },
    {
      "name": "duplicate",
      "description": "This issue or pull request already exists",
      "color": "cfd3d7"
    },
    {
      "name": "enhancement",
      "description": "New feature or request",
      "color": "a2eeef"
    },
    {
      "name": "good first issue",
      "description": "Good for newcomers",
      "color": "7057ff"
    },
    {
      "name": "help wanted",
      "description": "Extra attention is needed",
      "color": "008672"
    },
    {
      "name": "invalid",
      "description": "This doesn't seem right",
      "color": "e4e669"
    },
    {
      "name": "question",
      "description": "Further information is requested",
      "color": "d876e3"
    },
    {
      "name": "wontfix",
      "description": "This will not be worked on",
      "color": "ffffff"
    }
  ],
  "issues": [
    {
      "number": 3,
      "id": "I_kwDONVsH1s6k9lEq",
      "title": "Clarify introduction bullet 1",
      "url": "https://github.com/danvangeest/cms-euf-cma-signeddata/issues/3",
      "state": "OPEN",
      "author": "danvangeest",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [],
      "body": "From Carl Wallace's comment: https://mailarchive.ietf.org/arch/msg/spasm/hiSdxAHAfj0nmBqZhO8NlQJMDUQ/\r\n\r\nIn the introduction, bullet 1 is incomplete. Simply removing SignedAttributes does nothing of value for an attacker. It should probably say something like: \"Take an arbitrary CMS signed message M which was originally signed with SignedAttributes present and rearrange the structure such that the SignedAttributes field is absent and the original DER-encoded SignedAttributes appears as an encapsulated or detached content of type id-data, thereby crafting a new structure M' that was never explicitly signed by the signer.\"",
      "createdAt": "2025-01-03T13:47:22Z",
      "updatedAt": "2025-01-03T13:47:22Z",
      "closedAt": null,
      "comments": []
    },
    {
      "number": 4,
      "id": "I_kwDONVsH1s6k9o0P",
      "title": "Caution against using id-data for new protocols",
      "url": "https://github.com/danvangeest/cms-euf-cma-signeddata/issues/4",
      "state": "OPEN",
      "author": "danvangeest",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [],
      "body": "From Carl Wallace's comment: https://mailarchive.ietf.org/arch/msg/spasm/hiSdxAHAfj0nmBqZhO8NlQJMDUQ/\r\n\r\n4.2 might include a note cautioning against use of id-data for new protocols. A draft that prohibits any new use of id-data in protocols may be worthwhile a well.",
      "createdAt": "2025-01-03T13:58:20Z",
      "updatedAt": "2025-01-03T13:58:20Z",
      "closedAt": null,
      "comments": []
    },
    {
      "number": 5,
      "id": "I_kwDONVsH1s6k9v9s",
      "title": "Mention id-data in Security Considerations",
      "url": "https://github.com/danvangeest/cms-euf-cma-signeddata/issues/5",
      "state": "OPEN",
      "author": "danvangeest",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [],
      "body": "From Carl Wallace's comment: https://mailarchive.ietf.org/arch/msg/spasm/hiSdxAHAfj0nmBqZhO8NlQJMDUQ/\r\n\r\nThe first security consideration may benefit from noting any protocol that does not use id-data requires SignedAttributes and thus provides a defense against this vulnerability. https://www.iana.org/assignments/media-types/application/cms has a partial list of such protocols.",
      "createdAt": "2025-01-03T14:19:01Z",
      "updatedAt": "2025-01-03T14:19:01Z",
      "closedAt": null,
      "comments": []
    }
  ],
  "pulls": [
    {
      "number": 1,
      "id": "PR_kwDONVsH1s6ELjPw",
      "title": "Detailed attack description; further proposed changes",
      "url": "https://github.com/danvangeest/cms-euf-cma-signeddata/pull/1",
      "state": "MERGED",
      "author": "falko-strenzke",
      "authorAssociation": "COLLABORATOR",
      "assignees": [],
      "labels": [],
      "body": "",
      "createdAt": "2024-12-05T13:00:26Z",
      "updatedAt": "2024-12-05T15:16:36Z",
      "baseRepository": "danvangeest/cms-euf-cma-signeddata",
      "baseRefName": "main",
      "baseRefOid": "ad2d2f5e767e7adb383005cbb6b5902a3e2d1ea3",
      "headRepository": "danvangeest/cms-euf-cma-signeddata",
      "headRefName": "suggestion-falko-2024-12-05",
      "headRefOid": "aabb2162c490feb4bdfa9869fea75c028519947b",
      "closedAt": "2024-12-05T15:16:24Z",
      "mergedAt": "2024-12-05T15:16:24Z",
      "mergedBy": "danvangeest",
      "mergeCommit": {
        "oid": "1b82bad118c97e296fba31b1534cc49fd9e73782"
      },
      "comments": [],
      "reviews": [
        {
          "id": "PRR_kwDONVsH1s6T8I2g",
          "commit": {
            "abbreviatedOid": "aabb216"
          },
          "author": "danvangeest",
          "authorAssociation": "OWNER",
          "state": "APPROVED",
          "body": "",
          "createdAt": "2024-12-05T15:16:00Z",
          "updatedAt": "2024-12-05T15:16:00Z",
          "comments": []
        }
      ]
    },
    {
      "number": 2,
      "id": "PR_kwDONVsH1s6EM3HW",
      "title": "Falko's comments",
      "url": "https://github.com/danvangeest/cms-euf-cma-signeddata/pull/2",
      "state": "MERGED",
      "author": "danvangeest",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [],
      "body": "",
      "createdAt": "2024-12-05T15:36:01Z",
      "updatedAt": "2024-12-05T15:47:54Z",
      "baseRepository": "danvangeest/cms-euf-cma-signeddata",
      "baseRefName": "main",
      "baseRefOid": "1b82bad118c97e296fba31b1534cc49fd9e73782",
      "headRepository": "danvangeest/cms-euf-cma-signeddata",
      "headRefName": "dvg/falkos_comments",
      "headRefOid": "c596fd51d6e430880bd1234cd7f311427fc48a98",
      "closedAt": "2024-12-05T15:41:05Z",
      "mergedAt": "2024-12-05T15:41:05Z",
      "mergedBy": "falko-strenzke",
      "mergeCommit": {
        "oid": "30e36657edaf7d74aff595077eeebe8a2da8b0de"
      },
      "comments": [],
      "reviews": [
        {
          "id": "PRR_kwDONVsH1s6T8bHF",
          "commit": {
            "abbreviatedOid": "c596fd5"
          },
          "author": "falko-strenzke",
          "authorAssociation": "COLLABORATOR",
          "state": "APPROVED",
          "body": "",
          "createdAt": "2024-12-05T15:40:55Z",
          "updatedAt": "2024-12-05T15:40:55Z",
          "comments": []
        }
      ]
    },
    {
      "number": 6,
      "id": "PR_kwDONVsH1s6HWFcT",
      "title": "Add a section briefly exploring RFCs using the id-data eContentType",
      "url": "https://github.com/danvangeest/cms-euf-cma-signeddata/pull/6",
      "state": "OPEN",
      "author": "danvangeest",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [],
      "body": "",
      "createdAt": "2025-01-10T15:22:11Z",
      "updatedAt": "2025-01-30T06:57:16Z",
      "baseRepository": "danvangeest/cms-euf-cma-signeddata",
      "baseRefName": "main",
      "baseRefOid": "30e36657edaf7d74aff595077eeebe8a2da8b0de",
      "headRepository": "danvangeest/cms-euf-cma-signeddata",
      "headRefName": "dvg/id_data_rfcs",
      "headRefOid": "3daf42c17abf31c34efa441c07bef10bc1497dc8",
      "closedAt": null,
      "mergedAt": null,
      "mergedBy": null,
      "mergeCommit": null,
      "comments": [
        {
          "author": "falko-strenzke",
          "authorAssociation": "COLLABORATOR",
          "body": "Looks good to me, thanks for making this addition.",
          "createdAt": "2025-01-13T07:48:58Z",
          "updatedAt": "2025-01-13T07:48:58Z"
        }
      ],
      "reviews": [
        {
          "id": "PRR_kwDONVsH1s6XvUAt",
          "commit": {
            "abbreviatedOid": "8e0bec0"
          },
          "author": "falko-strenzke",
          "authorAssociation": "COLLABORATOR",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2025-01-13T06:11:00Z",
          "updatedAt": "2025-01-13T06:11:00Z",
          "comments": [
            {
              "originalPosition": 65,
              "body": "I would put all S/MIME versions under one heading.",
              "createdAt": "2025-01-13T06:11:00Z",
              "updatedAt": "2025-01-13T06:11:01Z"
            }
          ]
        },
        {
          "id": "PRR_kwDONVsH1s6Xv2c_",
          "commit": {
            "abbreviatedOid": "8e0bec0"
          },
          "author": "falko-strenzke",
          "authorAssociation": "COLLABORATOR",
          "state": "APPROVED",
          "body": "",
          "createdAt": "2025-01-13T07:37:17Z",
          "updatedAt": "2025-01-13T07:37:17Z",
          "comments": []
        },
        {
          "id": "PRR_kwDONVsH1s6Zd-UD",
          "commit": {
            "abbreviatedOid": "3daf42c"
          },
          "author": "falko-strenzke",
          "authorAssociation": "COLLABORATOR",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2025-01-27T08:20:22Z",
          "updatedAt": "2025-01-27T08:20:22Z",
          "comments": [
            {
              "originalPosition": 14,
              "body": "It's not 100% true that the attack does not apply in such cases: Even where the SA are required, the signer may erroneously omit them (not a very realistic assumption, though). If the signer signs an attacker-supplied message without SA, then the attacker can make sure that the signed message is an SA structure that contains the required attributes for successful verification (and a message digest attribute for a message of his choice).",
              "createdAt": "2025-01-27T08:20:22Z",
              "updatedAt": "2025-01-27T08:20:23Z"
            }
          ]
        },
        {
          "id": "PRR_kwDONVsH1s6Z203G",
          "commit": {
            "abbreviatedOid": "3daf42c"
          },
          "author": "danvangeest",
          "authorAssociation": "OWNER",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2025-01-29T14:45:16Z",
          "updatedAt": "2025-01-29T14:45:16Z",
          "comments": [
            {
              "originalPosition": 14,
              "body": "@falko-strenzke do you think we need some additional text here?",
              "createdAt": "2025-01-29T14:45:16Z",
              "updatedAt": "2025-01-29T14:45:16Z"
            }
          ]
        },
        {
          "id": "PRR_kwDONVsH1s6Z9lKp",
          "commit": {
            "abbreviatedOid": "3daf42c"
          },
          "author": "falko-strenzke",
          "authorAssociation": "COLLABORATOR",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2025-01-30T06:57:16Z",
          "updatedAt": "2025-01-30T06:57:16Z",
          "comments": [
            {
              "originalPosition": 14,
              "body": "```suggestion\r\nAn RFC requiring or forbidding signed attributes does not necessarily mean that a verifier will enforce this requirement when verifying, their CMS implementation may simply process the message whether or not signed attributes are present.  If one of the signed attributes is necessary for the verifier to successfully verify the signature or to successfully process the CMS data then the attack will not apply; at least not when assuming the signer is well-behaved and always signs with signed attributes present in accordance with the applicable specification.\r\n```",
              "createdAt": "2025-01-30T06:57:16Z",
              "updatedAt": "2025-01-30T06:57:16Z"
            }
          ]
        }
      ]
    }
  ]
}