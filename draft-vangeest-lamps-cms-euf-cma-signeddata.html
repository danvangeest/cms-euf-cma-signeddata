<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>EUF-CMA for the Cryptographic Message Syntax (CMS) SignedData</title>
<meta content="Daniel Van Geest" name="author">
<meta content="Falko Strenzke" name="author">
<meta content="
       The Cryptographic Message Syntax (CMS) has different signature verification behaviour based on whether signed attributes are present or not.
This results in a potential existential forgery vulnerability in CMS and protocols which use CMS.
This document describes the vulnerability and lists a number of potential mitigations for LAMPS working group discussion. 
    " name="description">
<meta content="xml2rfc 3.26.0" name="generator">
<meta content="Cryptographic Message Syntax" name="keyword">
<meta content="CMS" name="keyword">
<meta content="draft-vangeest-lamps-cms-euf-cma-signeddata-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.26.0
    Python 3.12.8
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-vangeest-lamps-cms-euf-cma-signeddata.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">EUF-CMA for CMS SignedData</td>
<td class="right">February 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Van Geest &amp; Strenzke</td>
<td class="center">Expires 18 August 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Limited Additional Mechanisms for PKIX and SMIME</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-vangeest-lamps-cms-euf-cma-signeddata-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-02-14" class="published">14 February 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-08-18">18 August 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Van Geest</div>
<div class="org">CryptoNext Security</div>
</div>
<div class="author">
      <div class="author-name">F. Strenzke</div>
<div class="org">MTG AG</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">EUF-CMA for the Cryptographic Message Syntax (CMS) SignedData</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The Cryptographic Message Syntax (CMS) has different signature verification behaviour based on whether signed attributes are present or not.
This results in a potential existential forgery vulnerability in CMS and protocols which use CMS.
This document describes the vulnerability and lists a number of potential mitigations for LAMPS working group discussion.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://danvangeest.github.io/cms-euf-cma-signeddata/draft-vangeest-lamps-cms-euf-cma-signeddata.html">https://danvangeest.github.io/cms-euf-cma-signeddata/draft-vangeest-lamps-cms-euf-cma-signeddata.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-vangeest-lamps-cms-euf-cma-signeddata/">https://datatracker.ietf.org/doc/draft-vangeest-lamps-cms-euf-cma-signeddata/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Limited Additional Mechanisms for PKIX and SMIME Working Group mailing list (<span><a href="mailto:spasm@ietf.org">mailto:spasm@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/spasm/">https://mailarchive.ietf.org/arch/browse/spasm/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/spasm/">https://www.ietf.org/mailman/listinfo/spasm/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/danvangeest/cms-euf-cma-signeddata">https://github.com/danvangeest/cms-euf-cma-signeddata</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 18 August 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-potential-mitigations" class="internal xref">Potential Mitigations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-immediate-forced-use-of-spe" class="internal xref">Immediate Forced Use of Specific Signature Context Strings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-attribute-specified-use-of-" class="internal xref">Attribute-Specified Use of Implicit Signature Context Strings</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-signing" class="internal xref">Signing</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-verifying" class="internal xref">Verifying</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-attribute-specified-use-of-e" class="internal xref">Attribute-Specified Use of Explicit Signature Context Strings</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-straw-mitigations" class="internal xref">Straw Mitigations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-attack-detection-in-cms" class="internal xref">Attack Detection in CMS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-always-never-use-signedattr" class="internal xref">Always/Never use SignedAttributes in Your Protocol</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-attack-detection-in-your-pr" class="internal xref">Attack Detection in Your Protocol</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-rfcs-using-the-id-data-econ" class="internal xref">RFCs Using the id-data eContentType</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-rfc-8894-simple-certificate" class="internal xref">RFC 8894 Simple Certificate Enrolment Protocol</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-rfc-8572-secure-zero-touch-" class="internal xref">RFC 8572 Secure Zero Touch Provisioning (SZTP)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-s-mime-rfcs" class="internal xref">S/MIME RFCs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-rfc-6257-bundle-security-pr" class="internal xref">RFC 6257 Bundle Security Protocol Specification</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-rfc-5655-ip-flow-informatio" class="internal xref">RFC 5655 IP Flow Information Export (IPFIX)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="auto internal xref">5.6</a>.  <a href="#name-rfc-5636-traceable-anonymou" class="internal xref">RFC 5636 Traceable Anonymous Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="auto internal xref">5.7</a>.  <a href="#name-rfc-5126-cms-advanced-elect" class="internal xref">RFC 5126 CMS Advanced Electronic Signatures (CAdES)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a href="#section-5.8" class="auto internal xref">5.8</a>.  <a href="#name-rfc-5024-odette-file-transf" class="internal xref">RFC 5024 ODETTE File Transfer Protocol 2</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a href="#section-5.9" class="auto internal xref">5.9</a>.  <a href="#name-rfc-3126-electronic-signatu" class="internal xref">RFC 3126 Electronic Signature Formats for long term electronic signatures</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Cryptographic Message Syntax (CMS) <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span> signed-data content type allows any number of signers in parallel to sign any type of content.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">CMS gives a signer two options when generating a signature on some content:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">
          <p id="section-1-3.1.1">Generate a signature on the whole content; or<a href="#section-1-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.2">
          <p id="section-1-3.2.1">Compute a hash over the content, place this hash in the message-digest attribute in the SignedAttributes type, and generate a signature on the SignedAttributes.<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-4">The resulting signature does not commit to the presence of the SignedAttributes type, allowing an attacker to influence verification behaviour.
An attacker can perform two different types of attacks:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-5">
<li id="section-1-5.1">
          <p id="section-1-5.1.1">Take an arbitrary CMS signed message M which was originally signed with SignedAttributes present and remove the SignedAttributes, thereby crafting a new message M' that was never signed by the signer.  M' has the DER-encoded SignedAttributes of the original message as its content and verifies correctly against the original signature of M.<a href="#section-1-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-1-5.2">
          <p id="section-1-5.2.1">Let the signer sign a message of the attacker's choice without SignedAttributes.
The attacker chooses this message to be a valid DER-encoding of a SignedAttributes object.
He can then add this encoded SignedAttributes object to the signed message and change the signed message to the one that was used to create the messageDigest attribute within the SignedAttributes.
The signature created by the signer is valid for this arbitrary attacker-chosen message.<a href="#section-1-5.2.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-1-6">This vulnerability was presented by Falko Strenzke at IETF 121 <span>[<a href="#LAMPS121" class="cite xref">LAMPS121</a>]</span> and is detailed in <span>[<a href="#Str23" class="cite xref">Str23</a>]</span>.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">Due to the limited flexibility of either the signed or the forged message in either attack variant, the fraction of vulnerable systems can be assumed to be small. But due to the wide deployment of the affected protocols, such instances cannot be excluded.<a href="#section-1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="potential-mitigations">
<section id="section-3">
      <h2 id="name-potential-mitigations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-potential-mitigations" class="section-name selfRef">Potential Mitigations</a>
      </h2>
<p id="section-3-1">Potential mitigations are described in the following sub-sections as input to the working group discussion.
If this draft is adopted and the working group has taken a decision which measure(s) should be realized, we'll describe the chosen measures in detail.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The mitigations in this section make use of a context string which is passed to the signature algorithm's sign and verify functions.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">ML-DSA <span>[<a href="#FIPS204" class="cite xref">FIPS204</a>]</span>, SLH-DSA <span>[<a href="#FIPS205" class="cite xref">FIPS205</a>]</span>, Composite ML-DSA <span>[<a href="#I-D.ietf-lamps-pq-composite-sigs" class="cite xref">I-D.ietf-lamps-pq-composite-sigs</a>]</span>, and Ed448 <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span> take a context string during signing and verification.
The context string may be up to 255 bytes long.
By default the context string is the empty string.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-4">
<pre>
   Sign(sk, M, ctx="")
   Verify(sk, M, ctx="")
</pre><a href="#section-3-4" class="pilcrow">¶</a>
</div>
<p id="section-3-5">RSA, ECDSA and Ed25519 signatures do not take a context string and would not be helped by these mitigations.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">Ed448 can take a context string but does not currently in CMS <span>[<a href="#RFC8419" class="cite xref">RFC8419</a>]</span>.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">Ed25519ctx <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span> takes a context string but is not specified for use in CMS.<a href="#section-3-7" class="pilcrow">¶</a></p>
<div id="immediate">
<section id="section-3.1">
        <h3 id="name-immediate-forced-use-of-spe">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-immediate-forced-use-of-spe" class="section-name selfRef">Immediate Forced Use of Specific Signature Context Strings</a>
        </h3>
<p id="section-3.1-1">Immediately update <span>[<a href="#I-D.ietf-lamps-cms-ml-dsa" class="cite xref">I-D.ietf-lamps-cms-ml-dsa</a>]</span>, <span>[<a href="#I-D.ietf-lamps-cms-sphincs-plus" class="cite xref">I-D.ietf-lamps-cms-sphincs-plus</a>]</span>, and <span>[<a href="#I-D.ietf-lamps-pq-composite-sigs" class="cite xref">I-D.ietf-lamps-pq-composite-sigs</a>]</span> to require a context string, with a different value for use with and without signated attributes.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">When signed attributes are present:<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-3">
<pre>
   Sign(sk, M, "signed-attributes")
   Verify(sk, M, "signed-attributes")
</pre><a href="#section-3.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.1-4">When signed attributes are absent:<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-5">
<pre>
   Sign(sk, M, "no-signed-attributes")
   Verify(sk, M, "no-signed-attributes")
</pre><a href="#section-3.1-5" class="pilcrow">¶</a>
</div>
<p id="section-3.1-6">Unlike the following mitigations, Ed448 cannot be addressed by this mitigation because it is already published and in use.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implicit">
<section id="section-3.2">
        <h3 id="name-attribute-specified-use-of-">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-attribute-specified-use-of-" class="section-name selfRef">Attribute-Specified Use of Implicit Signature Context Strings</a>
        </h3>
<p id="section-3.2-1">Like <a href="#immediate" class="auto internal xref">Section 3.1</a>, but the use of the signature context string is indicated by a new, empty (or attribute value ignored), sign-with-context-implicit unsigned attribute.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2"><span>[<a href="#I-D.ietf-lamps-cms-ml-dsa" class="cite xref">I-D.ietf-lamps-cms-ml-dsa</a>]</span>, <span>[<a href="#I-D.ietf-lamps-cms-sphincs-plus" class="cite xref">I-D.ietf-lamps-cms-sphincs-plus</a>]</span>, and <span>[<a href="#I-D.ietf-lamps-pq-composite-sigs" class="cite xref">I-D.ietf-lamps-pq-composite-sigs</a>]</span> can be published using the default signature context string.  ML-DSA, SLH-DSA, Composite-ML-DSA, and Ed448 only use the non-default context string when the new attribute is used.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<div id="signing">
<section id="section-3.2.1">
          <h4 id="name-signing">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-signing" class="section-name selfRef">Signing</a>
          </h4>
<p id="section-3.2.1-1">When signed attributes are present:<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.1-2">
<pre>
   unsigned-attributes.add(sign-with-context-implicit)
   Sign(sk, M, "signed-attributes")
</pre><a href="#section-3.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2.1-3">When signed attributes are absent:<a href="#section-3.2.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.1-4">
<pre>
   unsigned-attributes.add(sign-with-context-implicit)
   Sign(sk, M, "no-signed-attributes")
</pre><a href="#section-3.2.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="verifying">
<section id="section-3.2.2">
          <h4 id="name-verifying">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-verifying" class="section-name selfRef">Verifying</a>
          </h4>
<p id="section-3.2.2-1">When signed attributes are present:<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.2-2">
<pre>
   IF unsigned-attributes.contains(sign-with-context-implicit)
   THEN Verify(sk, M, "signed-attributes")
   ELSE Verify(sk, M, "")
</pre><a href="#section-3.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2.2-3">When signed attributes are absent:<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.2-4">
<pre>
   IF unsigned-attributes.contains(sign-with-context-implicit)
   THEN Verify(sk, M, "no-signed-attributes")
   ELSE Verify(sk, M, "")
</pre><a href="#section-3.2.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="attribute-specified-use-of-explicit-signature-context-strings">
<section id="section-3.3">
        <h3 id="name-attribute-specified-use-of-e">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-attribute-specified-use-of-e" class="section-name selfRef">Attribute-Specified Use of Explicit Signature Context Strings</a>
        </h3>
<p id="section-3.3-1">Like <a href="#implicit" class="auto internal xref">Section 3.2</a> but the new unsigned attribute (sign-with-context-explict) contains a semi-colon-delimited list of keyword (and optional value) strings.
This addresses the possibility of future CMS features that require context parameters.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-2">
<pre>
   ctx = "&lt;keyword_1&gt;[=value1];...;&lt;keyword_n&gt;[=value]"
</pre><a href="#section-3.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.3-3">The list is ordered alphabetically by type string.
This list is validated by the verifier and used as the signature context string.
(alternative: the SHA-256 hash of the list is used as the signature context string to avoid it getting too long)<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">A proposed list of initial signature context string keywords follows:<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<span id="name-potential-context-string-ke"></span><table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-potential-context-string-ke" class="selfRef">Potential Context String Keywords</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">keyword</th>
              <th class="text-left" rowspan="1" colspan="1">value</th>
              <th class="text-left" rowspan="1" colspan="1">comment</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">"IETF/CMS"</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">
                <span class="bcp14">REQUIRED</span> to be in the sign-with-context-implicit attribute, to differentiate a signature in CMS from a signature with the same private key over some other data.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">"signed-attrs"</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Present if signed attributes are used, not present if signed attributes are not used. Alternative: always present, value = 0/1, yes/no depending on whether signed attributes are present or not.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">"app-ctx"</td>
              <td class="text-left" rowspan="1" colspan="1">base64( SHA-256( protocol_context ) )</td>
              <td class="text-left" rowspan="1" colspan="1">Allows the protocol using CMS to specify a context. SHA-256 is applied so that the length available to the protocol context isn't dependent on the other context values used in CMS. (alternative: no SHA-256 here, apply SHA-256 to the whole CMS context). base64-encoding is applied so the app context doesn't introduce semi-colons to mess up CMS' parsing of this string.</td>
            </tr>
          </tbody>
        </table>
<p id="section-3.3-6">When a verifier processes a SignerInfo containing the sign-with-context-explicit attribute, it <span class="bcp14">MUST</span> perform the following consistency checks:<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-7.1">
            <p id="section-3.3-7.1.1">If the "signed-attrs" keyword is present and SignedAttributes is not present in the SignerInfo, fail verification.<a href="#section-3.3-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-7.2">
            <p id="section-3.3-7.2.1">If the "signed-attrs" keyword is not present and SignedAttributes is present in the SignerInfo, fail verification.<a href="#section-3.3-7.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-8">If the consistency checks pass, the signature is verified using the string in the sign-with-context-explicit attribute as the signature context (alternative: using SHA-256 of the string in the sign-with-context-explicit attribute).<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<p id="section-3.3-9">When a verifier processes a SignerInfo without the sign-with-context-explicit attribute, they <span class="bcp14">MUST</span> verify the signature using the default signature context value ("").<a href="#section-3.3-9" class="pilcrow">¶</a></p>
<p id="section-3.3-10"><span>[<a href="#I-D.ietf-lamps-cms-ml-dsa" class="cite xref">I-D.ietf-lamps-cms-ml-dsa</a>]</span>, <span>[<a href="#I-D.ietf-lamps-cms-sphincs-plus" class="cite xref">I-D.ietf-lamps-cms-sphincs-plus</a>]</span>, and <span>[<a href="#I-D.ietf-lamps-pq-composite-sigs" class="cite xref">I-D.ietf-lamps-pq-composite-sigs</a>]</span> can be published using the default signature context string.  ML-DSA, SLH-DSA, Composite-ML-DSA, and Ed448 only use the non-default context string when the new attribute is used.<a href="#section-3.3-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="straw-mitigations">
<section id="section-4">
      <h2 id="name-straw-mitigations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-straw-mitigations" class="section-name selfRef">Straw Mitigations</a>
      </h2>
<p id="section-4-1">The following mitigations might not be good ideas but are included just in case there's a seed of genius in them.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="attack-detection">
<section id="section-4.1">
        <h3 id="name-attack-detection-in-cms">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-attack-detection-in-cms" class="section-name selfRef">Attack Detection in CMS</a>
        </h3>
<p id="section-4.1-1">If SignedAttributes is not present, check if the signed message is a valid DER-encoded SignedAttributes structure and fail if it is.
The mandatory contentType and messageDigest attributes, with their respective OIDs, should give a low probability of a legitimate message being flagged.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">If an application protocol deliberately uses such a signed messages, verification would fail.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">This mitigation does not address the inverse problem where a protocol doesn't used SignedAttributes but for some reason often sends messages which happen to be formatted like valid SignedAttributes encodings, with attacker-controlled bytes where the message digest attribute would be.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="alwaysnever-use-signedattributes-in-your-protocol">
<section id="section-4.2">
        <h3 id="name-always-never-use-signedattr">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-always-never-use-signedattr" class="section-name selfRef">Always/Never use SignedAttributes in Your Protocol</a>
        </h3>
<p id="section-4.2-1">Individually update each protocol which use CMS to always require or forbid signed attributes.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attack-detection-in-your-protocol">
<section id="section-4.3">
        <h3 id="name-attack-detection-in-your-pr">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-attack-detection-in-your-pr" class="section-name selfRef">Attack Detection in Your Protocol</a>
        </h3>
<p id="section-4.3-1"><a href="#attack-detection" class="auto internal xref">Section 4.1</a> but specified in the protocol that uses CMS rather than CMS itself.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="rfcs-using-the-id-data-econtenttype">
<section id="section-5">
      <h2 id="name-rfcs-using-the-id-data-econ">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-rfcs-using-the-id-data-econ" class="section-name selfRef">RFCs Using the id-data eContentType</a>
      </h2>
<p id="section-5-1">The RFCs in the following subsections use the id-data eContentType. This table summarizes their usages of signed attributes.<a href="#section-5-1" class="pilcrow">¶</a></p>
<span id="name-rfcs-using-id-data"></span><table class="center" id="table-2">
        <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-rfcs-using-id-data" class="selfRef">RFCs using id-data</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">RFC</th>
            <th class="text-left" rowspan="1" colspan="1">Signed Attributes Usage</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC8994" class="cite xref">RFC8994</a>]</span>
</td>
            <td class="text-left" rowspan="1" colspan="1">Requires the used of signed attributes</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC8572" class="cite xref">RFC8572</a>]</span>
</td>
            <td class="text-left" rowspan="1" colspan="1">Says nothing about signed attributes</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC8551" class="cite xref">RFC8551</a>]</span>
</td>
            <td class="text-left" rowspan="1" colspan="1">RECOMMENDS signed attributes</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC6257" class="cite xref">RFC6257</a>]</span>
</td>
            <td class="text-left" rowspan="1" colspan="1">Forbids signed attributes</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC5751" class="cite xref">RFC5751</a>]</span>
</td>
            <td class="text-left" rowspan="1" colspan="1">RECOMMENDS signed attributes</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC5655" class="cite xref">RFC5655</a>]</span>
</td>
            <td class="text-left" rowspan="1" colspan="1">Says nothing about signed attributes</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC5636" class="cite xref">RFC5636</a>]</span>
</td>
            <td class="text-left" rowspan="1" colspan="1">Forbids signed attributes</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC5126" class="cite xref">RFC5126</a>]</span>
</td>
            <td class="text-left" rowspan="1" colspan="1">Requires signed attributes</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC5024" class="cite xref">RFC5024</a>]</span>
</td>
            <td class="text-left" rowspan="1" colspan="1">Says nothing about signed attributes</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC3851" class="cite xref">RFC3851</a>]</span>
</td>
            <td class="text-left" rowspan="1" colspan="1">RECOMMENDS signed attributes</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC3126" class="cite xref">RFC3126</a>]</span>
</td>
            <td class="text-left" rowspan="1" colspan="1">Requires signed attributes</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC2633" class="cite xref">RFC2633</a>]</span>
</td>
            <td class="text-left" rowspan="1" colspan="1">RECOMMENDS signed attributes</td>
          </tr>
        </tbody>
      </table>
<p id="section-5-3">An RFC requiring or forbidding signed attributes does not necessarily mean that a verifier will enforce this requirement when verifying, their CMS implementation may simply process the message whether or not signed attributes are present.  If one of the signed attributes is necessary for the verifier to successfully verify the signature or to successfully process the CMS data then the attack will not apply; at least not when assuming the signer is well-behaved and always signs with signed attributes present in accordance with the applicable specification.<a href="#section-5-3" class="pilcrow">¶</a></p>
<div id="rfc-8894-simple-certificate-enrolment-protocol">
<section id="section-5.1">
        <h3 id="name-rfc-8894-simple-certificate">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-rfc-8894-simple-certificate" class="section-name selfRef">RFC 8894 Simple Certificate Enrolment Protocol</a>
        </h3>
<p id="section-5.1-1">Figure 6 in <span><a href="https://rfc-editor.org/rfc/rfc8894#section-3" class="relref">Section 3</a> of [<a href="#RFC8894" class="cite xref">RFC8894</a>]</span> specifies id-data as the eContentType, and shows the use of signedAttrs.  The document itself never refers to signed attributes, but instead to authenticated attributes and an authenticatedAttributes type.  Errata ID 8247 clarifies that it should be "signed attributes" and "signedAttrs".<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Since SCEP requires the use of signedAttrs with the id-data eContentType, and the recipient must process at least some of the signed attributes, it is not affected by the attack.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-8572-secure-zero-touch-provisioning-sztp">
<section id="section-5.2">
        <h3 id="name-rfc-8572-secure-zero-touch-">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-rfc-8572-secure-zero-touch-" class="section-name selfRef">RFC 8572 Secure Zero Touch Provisioning (SZTP)</a>
        </h3>
<p id="section-5.2-1"><span><a href="https://rfc-editor.org/rfc/rfc8572#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8572" class="cite xref">RFC8572</a>]</span> allows the use of the id-data eContentType, although it also defines more specific content types.  It does not say anything about signed attributes.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="smime-rfcs">
<section id="section-5.3">
        <h3 id="name-s-mime-rfcs">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-s-mime-rfcs" class="section-name selfRef">S/MIME RFCs</a>
        </h3>
<p id="section-5.3-1"><span>[<a href="#RFC8551" class="cite xref">RFC8551</a>]</span>, <span>[<a href="#RFC5751" class="cite xref">RFC5751</a>]</span>, <span>[<a href="#RFC3851" class="cite xref">RFC3851</a>]</span>, and <span>[<a href="#RFC2633" class="cite xref">RFC2633</a>]</span> require the use of the id-data eContentType.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2"><span><a href="https://rfc-editor.org/rfc/rfc8551#section-2.5" class="relref">Section 2.5</a> of [<a href="#RFC8551" class="cite xref">RFC8551</a>]</span> says:<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.3-3.1">
            <p id="section-5.3-3.1.1">Receiving agents <span class="bcp14">MUST</span> be able to handle zero or one instance of each
of the signed attributes listed here.  Sending agents <span class="bcp14">SHOULD</span> generate
one instance of each of the following signed attributes in each
S/MIME message:<a href="#section-5.3-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.3-4">and<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.3-5.1">
            <p id="section-5.3-5.1.1">Sending agents <span class="bcp14">SHOULD</span> generate one instance of the signingCertificate
or signingCertificateV2 signed attribute in each SignerInfo
structure.<a href="#section-5.3-5.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.3-6">So the use of signed attributes is not an absolute requirement.<a href="#section-5.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-6257-bundle-security-protocol-specification">
<section id="section-5.4">
        <h3 id="name-rfc-6257-bundle-security-pr">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-rfc-6257-bundle-security-pr" class="section-name selfRef">RFC 6257 Bundle Security Protocol Specification</a>
        </h3>
<p id="section-5.4-1"><span><a href="https://rfc-editor.org/rfc/rfc6257#section-4" class="relref">Section 4</a> of [<a href="#RFC6257" class="cite xref">RFC6257</a>]</span> says:<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4-2.1">
            <p id="section-5.4-2.1.1">In all cases where we use CMS, implementations <span class="bcp14">SHOULD NOT</span> include
additional attributes whether signed or unsigned, authenticated or
unauthenticated.<a href="#section-5.4-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="rfc-5655-ip-flow-information-export-ipfix">
<section id="section-5.5">
        <h3 id="name-rfc-5655-ip-flow-informatio">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-rfc-5655-ip-flow-informatio" class="section-name selfRef">RFC 5655 IP Flow Information Export (IPFIX)</a>
        </h3>
<p id="section-5.5-1"><span>[<a href="#RFC5655" class="cite xref">RFC5655</a>]</span> is a file format that uses CMS for detached signatures. It says nothing about the use of signed attributes.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-5636-traceable-anonymous-certificate">
<section id="section-5.6">
        <h3 id="name-rfc-5636-traceable-anonymou">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-rfc-5636-traceable-anonymou" class="section-name selfRef">RFC 5636 Traceable Anonymous Certificate</a>
        </h3>
<p id="section-5.6-1"><span><a href="https://rfc-editor.org/rfc/rfc5636#appendix-C.1.2" class="relref">Appendix C.1.2</a> of [<a href="#RFC5636" class="cite xref">RFC5636</a>]</span> says:<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.6-2.1">
            <p id="section-5.6-2.1.1">The signedAttr element <span class="bcp14">MUST</span> be omitted.<a href="#section-5.6-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="rfc-5126-cms-advanced-electronic-signatures-cades">
<section id="section-5.7">
        <h3 id="name-rfc-5126-cms-advanced-elect">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-rfc-5126-cms-advanced-elect" class="section-name selfRef">RFC 5126 CMS Advanced Electronic Signatures (CAdES)</a>
        </h3>
<p id="section-5.7-1"><span><a href="https://rfc-editor.org/rfc/rfc5126#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#RFC5126" class="cite xref">RFC5126</a>]</span> specifies mandatory signed attributes.<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<p id="section-5.7-2">One of the signed attributes is used to determine which certificate is used to verify the signature, so this CaDES is not affected by the attack.<a href="#section-5.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-5024-odette-file-transfer-protocol-2">
<section id="section-5.8">
        <h3 id="name-rfc-5024-odette-file-transf">
<a href="#section-5.8" class="section-number selfRef">5.8. </a><a href="#name-rfc-5024-odette-file-transf" class="section-name selfRef">RFC 5024 ODETTE File Transfer Protocol 2</a>
        </h3>
<p id="section-5.8-1"><span>[<a href="#RFC5024" class="cite xref">RFC5024</a>]</span> uses the id-data eContentType and says nothing about signed attributes.<a href="#section-5.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-3126-electronic-signature-formats-for-long-term-electronic-signatures">
<section id="section-5.9">
        <h3 id="name-rfc-3126-electronic-signatu">
<a href="#section-5.9" class="section-number selfRef">5.9. </a><a href="#name-rfc-3126-electronic-signatu" class="section-name selfRef">RFC 3126 Electronic Signature Formats for long term electronic signatures</a>
        </h3>
<p id="section-5.9-1"><span><a href="https://rfc-editor.org/rfc/rfc3126#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC3126" class="cite xref">RFC3126</a>]</span> requires the MessageDigest attribute, which is a signed attribute.<a href="#section-5.9-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">TODO Security<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The vulnerability is not present in systems where the use of SignedAttributes is mandatory, for example: SCEP, Certificate Transparency, RFC 4018 firmware update, German Smart Metering CMS data format.
However, this security relies on a correct implementation of the verification routine that ensures the presence of SignedAttributes.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">The vulnerability is also not present when the message is signed and then encrypted, as the attacker cannot learn the signature.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">Conceivably vulnerable systems (TODO: describe these better):<a href="#section-6-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-5.1">
          <p id="section-6-5.1.1">Unencrypted firmware update denial of service<a href="#section-6-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-5.2">
          <p id="section-6-5.2.1">Dense message space<a href="#section-6-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-5.3">
          <p id="section-6-5.3.1">Signing unstructured data<a href="#section-6-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-5.4">
          <p id="section-6-5.4.1">External signatures over unstructured data<a href="#section-6-5.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-5.5">
          <p id="section-6-5.5.1">Systems with permissive parsers<a href="#section-6-5.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document has no IANA actions.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5652">[RFC5652]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5652">https://www.rfc-editor.org/rfc/rfc5652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="FIPS204">[FIPS204]</dt>
        <dd>
<span class="refTitle">"Module-lattice-based digital signature standard"</span>, <span class="refContent">National Institute of Standards and Technology (U.S.)</span>, <span class="seriesInfo">DOI 10.6028/nist.fips.204</span>, <time datetime="2024-08" class="refDate">August 2024</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.fips.204">https://doi.org/10.6028/nist.fips.204</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS205">[FIPS205]</dt>
        <dd>
<span class="refTitle">"Stateless hash-based digital signature standard"</span>, <span class="refContent">National Institute of Standards and Technology (U.S.)</span>, <span class="seriesInfo">DOI 10.6028/nist.fips.205</span>, <time datetime="2024-08" class="refDate">August 2024</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.fips.205">https://doi.org/10.6028/nist.fips.205</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-cms-ml-dsa">[I-D.ietf-lamps-cms-ml-dsa]</dt>
        <dd>
<span class="refAuthor">S, B.</span>, <span class="refAuthor">R, A.</span>, and <span class="refAuthor">D. Van Geest</span>, <span class="refTitle">"Use of the ML-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-cms-ml-dsa-02</span>, <time datetime="2025-01-17" class="refDate">17 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-cms-ml-dsa-02">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-cms-ml-dsa-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-cms-sphincs-plus">[I-D.ietf-lamps-cms-sphincs-plus]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refAuthor">Fluhrer, S.</span>, <span class="refAuthor">Kampanakis, P.</span>, and <span class="refAuthor">B. Westerbaan</span>, <span class="refTitle">"Use of the SLH-DSA Signature Algorithm in the Cryptographic Message Syntax (CMS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-cms-sphincs-plus-19</span>, <time datetime="2025-01-13" class="refDate">13 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-cms-sphincs-plus-19">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-cms-sphincs-plus-19</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-pq-composite-sigs">[I-D.ietf-lamps-pq-composite-sigs]</dt>
        <dd>
<span class="refAuthor">Ounsworth, M.</span>, <span class="refAuthor">Gray, J.</span>, <span class="refAuthor">Pala, M.</span>, <span class="refAuthor">Klaußner, J.</span>, and <span class="refAuthor">S. Fluhrer</span>, <span class="refTitle">"Composite ML-DSA For use in X.509 Public Key Infrastructure and CMS"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-pq-composite-sigs-03</span>, <time datetime="2024-10-21" class="refDate">21 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-pq-composite-sigs-03">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-pq-composite-sigs-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LAMPS121">[LAMPS121]</dt>
        <dd>
<span class="refAuthor">Strenzke, F.</span>, <span class="refTitle">"EUF-CMA for CMS SignedData"</span>, <time datetime="2024-11-06" class="refDate">6 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/meeting/121/materials/slides-121-lamps-cms-euf-cma-00">https://datatracker.ietf.org/meeting/121/materials/slides-121-lamps-cms-euf-cma-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2633">[RFC2633]</dt>
        <dd>
<span class="refAuthor">Ramsdell, B., Ed.</span>, <span class="refTitle">"S/MIME Version 3 Message Specification"</span>, <span class="seriesInfo">RFC 2633</span>, <span class="seriesInfo">DOI 10.17487/RFC2633</span>, <time datetime="1999-06" class="refDate">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2633">https://www.rfc-editor.org/rfc/rfc2633</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3126">[RFC3126]</dt>
        <dd>
<span class="refAuthor">Pinkas, D.</span>, <span class="refAuthor">Ross, J.</span>, and <span class="refAuthor">N. Pope</span>, <span class="refTitle">"Electronic Signature Formats for long term electronic signatures"</span>, <span class="seriesInfo">RFC 3126</span>, <span class="seriesInfo">DOI 10.17487/RFC3126</span>, <time datetime="2001-09" class="refDate">September 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3126">https://www.rfc-editor.org/rfc/rfc3126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3851">[RFC3851]</dt>
        <dd>
<span class="refAuthor">Ramsdell, B., Ed.</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification"</span>, <span class="seriesInfo">RFC 3851</span>, <span class="seriesInfo">DOI 10.17487/RFC3851</span>, <time datetime="2004-07" class="refDate">July 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3851">https://www.rfc-editor.org/rfc/rfc3851</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5024">[RFC5024]</dt>
        <dd>
<span class="refAuthor">Friend, I.</span>, <span class="refTitle">"ODETTE File Transfer Protocol 2.0"</span>, <span class="seriesInfo">RFC 5024</span>, <span class="seriesInfo">DOI 10.17487/RFC5024</span>, <time datetime="2007-11" class="refDate">November 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5024">https://www.rfc-editor.org/rfc/rfc5024</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5126">[RFC5126]</dt>
        <dd>
<span class="refAuthor">Pinkas, D.</span>, <span class="refAuthor">Pope, N.</span>, and <span class="refAuthor">J. Ross</span>, <span class="refTitle">"CMS Advanced Electronic Signatures (CAdES)"</span>, <span class="seriesInfo">RFC 5126</span>, <span class="seriesInfo">DOI 10.17487/RFC5126</span>, <time datetime="2008-03" class="refDate">March 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5126">https://www.rfc-editor.org/rfc/rfc5126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5636">[RFC5636]</dt>
        <dd>
<span class="refAuthor">Park, S.</span>, <span class="refAuthor">Park, H.</span>, <span class="refAuthor">Won, Y.</span>, <span class="refAuthor">Lee, J.</span>, and <span class="refAuthor">S. Kent</span>, <span class="refTitle">"Traceable Anonymous Certificate"</span>, <span class="seriesInfo">RFC 5636</span>, <span class="seriesInfo">DOI 10.17487/RFC5636</span>, <time datetime="2009-08" class="refDate">August 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5636">https://www.rfc-editor.org/rfc/rfc5636</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5655">[RFC5655]</dt>
        <dd>
<span class="refAuthor">Trammell, B.</span>, <span class="refAuthor">Boschi, E.</span>, <span class="refAuthor">Mark, L.</span>, <span class="refAuthor">Zseby, T.</span>, and <span class="refAuthor">A. Wagner</span>, <span class="refTitle">"Specification of the IP Flow Information Export (IPFIX) File Format"</span>, <span class="seriesInfo">RFC 5655</span>, <span class="seriesInfo">DOI 10.17487/RFC5655</span>, <time datetime="2009-10" class="refDate">October 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5655">https://www.rfc-editor.org/rfc/rfc5655</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5751">[RFC5751]</dt>
        <dd>
<span class="refAuthor">Ramsdell, B.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Message Specification"</span>, <span class="seriesInfo">RFC 5751</span>, <span class="seriesInfo">DOI 10.17487/RFC5751</span>, <time datetime="2010-01" class="refDate">January 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5751">https://www.rfc-editor.org/rfc/rfc5751</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6257">[RFC6257]</dt>
        <dd>
<span class="refAuthor">Symington, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Weiss, H.</span>, and <span class="refAuthor">P. Lovell</span>, <span class="refTitle">"Bundle Security Protocol Specification"</span>, <span class="seriesInfo">RFC 6257</span>, <span class="seriesInfo">DOI 10.17487/RFC6257</span>, <time datetime="2011-05" class="refDate">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6257">https://www.rfc-editor.org/rfc/rfc6257</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8032">https://www.rfc-editor.org/rfc/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8419">[RFC8419]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Use of Edwards-Curve Digital Signature Algorithm (EdDSA) Signatures in the Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">RFC 8419</span>, <span class="seriesInfo">DOI 10.17487/RFC8419</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8419">https://www.rfc-editor.org/rfc/rfc8419</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8551">[RFC8551]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refAuthor">Ramsdell, B.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 4.0 Message Specification"</span>, <span class="seriesInfo">RFC 8551</span>, <span class="seriesInfo">DOI 10.17487/RFC8551</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8551">https://www.rfc-editor.org/rfc/rfc8551</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8572">[RFC8572]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Farrer, I.</span>, and <span class="refAuthor">M. Abrahamsson</span>, <span class="refTitle">"Secure Zero Touch Provisioning (SZTP)"</span>, <span class="seriesInfo">RFC 8572</span>, <span class="seriesInfo">DOI 10.17487/RFC8572</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8572">https://www.rfc-editor.org/rfc/rfc8572</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8894">[RFC8894]</dt>
        <dd>
<span class="refAuthor">Gutmann, P.</span>, <span class="refTitle">"Simple Certificate Enrolment Protocol"</span>, <span class="seriesInfo">RFC 8894</span>, <span class="seriesInfo">DOI 10.17487/RFC8894</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8894">https://www.rfc-editor.org/rfc/rfc8894</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8994">[RFC8994]</dt>
        <dd>
<span class="refAuthor">Eckert, T., Ed.</span>, <span class="refAuthor">Behringer, M., Ed.</span>, and <span class="refAuthor">S. Bjarnason</span>, <span class="refTitle">"An Autonomic Control Plane (ACP)"</span>, <span class="seriesInfo">RFC 8994</span>, <span class="seriesInfo">DOI 10.17487/RFC8994</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8994">https://www.rfc-editor.org/rfc/rfc8994</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Str23">[Str23]</dt>
      <dd>
<span class="refAuthor">Strenzke, F.</span>, <span class="refTitle">"ForgedAttributes: An Existential Forgery Vulnerability of CMS and PKCS#7 Signatures"</span>, <time datetime="2023-11-22" class="refDate">22 November 2023</time>, <span>&lt;<a href="https://ia.cr/2023/1801">https://ia.cr/2023/1801</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Daniel Van Geest</span></div>
<div dir="auto" class="left"><span class="org">CryptoNext Security</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:daniel.vangeest@cryptonext-security.com" class="email">daniel.vangeest@cryptonext-security.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Falko Strenzke</span></div>
<div dir="auto" class="left"><span class="org">MTG AG</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:falko.strenzke@mtg.de" class="email">falko.strenzke@mtg.de</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
